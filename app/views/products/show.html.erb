<p id="notice"><%= notice %></p>

<% if !@product_shared_by[0].nil? %>

<div class="vigme-product-header row">
	<div class="col-xs-offset-1 col-sm-offset-1 col-md-offset-3">
		<h3 class="vigme-header-3">People Who Saved This</h3>
	</div>
</div>
<div class="row">
	<div class="col-md-offset-3 col-xs-offset-1 col-sm-offset-1">
	<% @product_shared_by.each do |user| %>
		<% if current_user.id != user.id %>
			<a href="<%= profile_path + "/" + user.id.to_s %>">
				<% if user.avatar.exists? %>
					<%= image_tag user.avatar.url, :class => "vigme-product-header-image" %>
				<% else %>
					<%= image_tag "missing-image.png", :class => "vigme-product-header-image" %>
				<% end %>
			</a>
		<% end %>
	<% end %>	
	</div>
</div>
<% end %>
<div class="row">

	<div class="col-md-offset-2 col-md-8 vigme-line"></div>
</div>

<div class="row">
	<div class="col-xs-offset-1 col-sm-offset-1 col-md-offset-2">
	<p>
	 <h3 class="vigme-header-2"><%= @product.name %></h3>
	</p>
</div>
</div>

<div class="row">
<div class="col-md-4 col-md-offset-2 col-xs-offset-1 col-sm-offset-1 product-detail-padding">

 <img src="<%= @product.image_s3_url || "http://www.vigme.com/photos/" + @product.image_folder.to_s + "/" + @product.id.to_s %>" class="img-thumbnail" >
</div>
<% if user_signed_in? %>
<div class="vigme-button-div col-md-4 col-md-offset-0 col-xs-offset-1 col-sm-offset-1">

<%= button_to 'Buy', {controller: 'products', action: 'buy', :product => @product.id}, :method => :post, :class => 'vigme-button btn btn-primary', :remote => true, 'data-toggle' => 'modal', 'data-target' => '#buy_modal' %>

<%= button_to 'Save', {controller: 'products', action: 'share', :product => @product.id}, :method => :post, :class => 'vigme-button btn btn-primary', :remote => true, 'data-toggle' => 'modal', 'data-target' => '#list_modal' %>

<% else %>
<div class="vigme-button-div col-md-4">
<a href="/auth/facebook">
<button type="button" class="vigme-button btn btn-primary">Sign Up to Buy and Share!</button>
</a>


<% end %>
<% if !@retailer_user.nil? %>
<div class="row">
	<div class="col-md-10">
		<h3 class="vigme-header-3">
			Other products from <a href="/profile/<%= @retailer_user.id %>"><%= @retailer.name %></a>
		</h3>
	</div>
</div>
<div class="vigme-similar-products col-md-12">
	<%= render "shared/product_list_mini", products: @other_products_from_retailer %>
</div>
<% end %>
</div>

</div>

<div class="col-md-offset-2 col-md-8 vigme-line"></div>

<% if @similar_products.count != 0 %>

<div class="row">
	<div class="col-md-12 col-xs-offset-1 col-sm-offset-1 col-md-offset-2">
	<p>
	 <h3 class="vigme-header-3">People who liked this also liked</h3>
	</p>
</div>
</div>

<div class="row">
	<div id="product-list" class="col-md-10 col-md-offset-2">
	<%= render 'shared/product_list', products: @similar_products %>
	</div>
</div>

<a style="display: none"><%= button_to 'More', {:controller => "products", :action => "show", :more => 1}, id: 'more_products', :method => :get, remote: true %></a>

<% end %>

<div class="modal fade" id="buy_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div id="buy-modal-dialog" class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
      </div>


      <div id="buy_modal_body" class="modal-body">
      	<iframe name="buy_box" src="<%= @product.buy_url %>" frameborder="0" style="width:100%;height:100%"></iframe>

      </div>

    </div>
  </div>
</div>